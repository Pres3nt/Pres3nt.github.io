---

title: Hvv初级面试题--情景题目
categories: [Hvv行动, 面试题]

---

## 常见的端口信息

```python
21:FTP文件传输协议
22:SSH远程连接
23:TELNET远程连接
25:SMTP邮件服务
53:DNS域名系统
80:HTTP超文本传输协议
443:HTTPS安全超文本传输协议
1433:MSSQL,sql server
1521:oracle
3306:MYSQL
3389:windows远程桌面服务端口
6379:redis
7001:weblogic
8080:TCP，HTTP协议代理服务器：apache-tomcat默认端口号
27017:mongoDB
```

## SQL注入常见的特征

1. 一些常见的关键字：select,where,order,union,update,floor,exec,information_schema,extractvalue,delete,insert,ascii,table,from等
2. 一些常见的sql函数：user(),@@version,sn()等
3. 相关关键字或者函数可能会采取url编码

## SQL注入时，and or 被过滤了怎么办

1. 大小写变形
2. 编码
3. 注释
4. 双写

## 发现SQL注入点，有哪几种思路获取webshell

1. 是否能获取网站的绝对路径并且具备写入权限，如果可以则利用sqlmap --os--shell
2. 构造联合查询语句获得管理员地账号和密码，进入后台进行文件上传getshell

## 宽字节流量特征

1. %df %81
2. sql关键字select，delete，update，insert等

## SQL注入无回显地情况下怎么办

1. 通过时间盲注和布尔盲注进行逐字符地推断
2. DNS进行数据外带

## sqlmap中的level和risk的区别

- level控制攻击的准确性，数值越高，攻击准确性越高，但是攻击速度会变慢

- level级别越高发送的请求越多，并且在level3以上级别时会尝试对referer进行注入

  

- risk控制攻击的深度，数值越高，攻击的幅度越大，但是被发现的风险也会增加

- risk是风险系数，默认为1会测试大部分的测试语句，2会增加事件的测试语句，3会增加or语句的注入测试

## Get和Post方法的区别

1. get是通过url进行传输，post通过报文传输
2. get产生一个TCP数据包，post产生两个TCP数据包
3. get传参的长度受到url长度的限制，而post传参没有限制

## 如果网站get和post都做了防注入，还可以采用什么方法绕过

- cookie注入

## mysql5.0以上和5.0以下的区别

- 5.0以上版本存在infomation_schema数据库，5.0以下版本不存在information_schema数据库

## mysql写shell用到的函数

1. Select .....into outfile
2. Dumpfile
3. file_get_contents

## Outfile不能用了怎么办

- 用into dumpfile

## ssh的加固方式

1. 禁用root用户登录
2. 更改默认端口
3. 设置白名单控制用户访问
4. 使用ssh密钥连接

## 为何一个mysql数据库的站，只有一个80端口开放

1. 更改了数据库端口，没有扫描出来
2. 站库分离
3. 3306端口不对外开放

## 如何通过xss实现权限驻留

- 写入xss到登录成功页面，利用beef或者xss平台，实时监控cookie等凭据，实现权限维持

## xss弹窗函数和常见的xss绕过策略

弹窗函数：alert(),confirm(),prompt(),onclick()

绕过策略：大小写，双写，%0a或者%0d绕过，拼凑绕过，<imag/src=1>

## phpmyadmin获取shell的方法

1. 常规导入shell的方法
2. 一句话木马导出shell
3. 日志备份获取shell

## 在后台看到编辑器应该做什么

- 查看编辑器的版本，搜索公开的漏洞

## 上传马之后访问是乱码怎么办

- 浏览器改编码

## 看到一个txt文件的下载地址怎么办

- 尝试下载敏感文件，/etc/passwd和网站配置文件等

## CSRF与XSS的区别

1. XSS劫持用户cookie，csrf是利用cookie
2. xss主要攻击客户端，csrf主要攻击服务端
3. xss无需登录，csrf需要登录

## CSRF，SSRF和重放攻击的区别

1. csrf是跨站请求伪造攻击，由客户端发起
2. ssrf是服务端请求伪造，由服务端发起
3. 重放攻击是将截获的数据包进行重放，达到身份认证的目的

## ssrf如何用redis写shell

1. Weblogic ssrf漏洞
2. gopher协议操作内网的redis，利用redis将反弹shell写入crontab定时任务。

## ssrf流量特征

1. 请求目标地址可能是内部网段的IP地址或者指向本地主机（localhost/127.0.0.1）
2. 请求端口不是正常的80或者443，而是内部服务的端口，如6379，3306，11211等
3. URL上存在file/gopher/ftp/dict等协议来访问目标资源

## ssrf漏洞相关的函数

1. file_get_content：将整个文件或url指向的文件读入一个字符串中
2. Curl_exec：初始化一个新的会话
3. fopen：打开一个文件或者URL
4. readfile：输出一个文件的内容

## csrf漏洞相关的函数

1. file_get_cpntent
2. curl_exec

## 本地包含和远程包含的区别

1. 本地包含只需要把木马上传到对方服务器，通过本地包含漏洞直接包含木马脚本，木马运行就能getshell
2. 远程包含需要服务器关闭魔术符号和开启远程包含功能才可以

## 代码执行函数有哪些

1. Eval
2. Assert
3. Calluserfunc
4. create_function
5. calluserfuncarray

## 文件读取函数有哪些

1. filegetcontents()
2. highlight_file()
3. read()
4. file()
5. fread()
6. fgets()
7. show_source()

## 命令执行函数有哪些

1. system()
2. exec()
3. shellexec()

## 进程排查的思路

1. CPU或者内存资源占用长时间过高的进程
2. 可以用工具的话进行工具检查
3. 手动检查进程的启动用户，进程的详细信息以及进程的路径

## 给你一个登录框如何测试

1. 目录扫描
2. 查CMS框架
3. 源代码审查，JS代码分析
4. 弱口令爆破
5. 找回密码功能，BP抓包，观察有没有可利用信息
6. 有输入框的地方，BP抓包，看看是否能注入
7. 有子框的地方可以测试下XSS

## 一个较大的日志该如何分析

1. 攻击流量特征匹配
2. 请求次数的一个统计
3. 使用日志分析工具，logforensics，graylog，nagios等

## mysql数据库提权方法

1. udf提权
2. mof提权

## udf提权原理

- root权限，创建带有调用cmd函数的udf.dll动态链接库，导出udf.dll文件后，就可以进行命令执行

## windows权限维持的办法

1. 修改注册表类
2. 增加计划任务

## linux权限维持的办法

1. ssh后门
2. suid后门
3. vim后门
4. pam后门
5. strace后门

## 如何识别是否存在CDN

1. 使用多地来ping，查看对应的IP地址是否唯一，如果不唯一，大概率存在cdn
2. 使用nslookup检测，查看返回的域名解析对应ip地址是否唯一，如果不唯一，则存在CDN

## 如何绕过CDN找到真实的IP

1. 查询域名历史解析记录
2. 收集子域信息，辅助判断真实IP
3. 查询SSL证书
4. php探针

## windows常用的提权方法

1. 数据库提权
2. web中间件漏洞提权
3. 第三方软件/服务提权
4. 系统漏洞提权

## linux常用的提权办法

1. 系统内核漏洞提权
2. suid提权
3. sudo提权
4. 泄露密码提权

## 数据库备份怎么拿shell

- 上传一句话木马，把一句话木马文件备份成为.cer或.asp

## 如果服务器出现大量的4625，是什么攻击？

- 无尽尝试，一直使用密码破解登录，弱口令爆破尝试

## 登录一个网站后台后getshell的方法

1. 文件上传漏洞，寻找文件上传处，想办法上传PHP文件
2. 是否知道网站的绝对路径，利用SQL注入
3. 中间件版本getshell
4. 数据库备份getshell
5. 寻找有没有任意文件包含的地方

## 如何拿一个站点的webshell

1. 文件上传，插件上传，程序部署
2. 后台编辑模板
3. SQL注入写文件
4. 命令执行，代码执行
5. 已爆出漏洞的CMS

## 如何判断webshell工具是否是二次开发

1. 代码分析（检查源代码，查找相似度，对比webshell工具与已知工具的代码差异）
2. 功能对比（对比webshell工具与已知工具的功能差异）
3. 查看开发文档（如果工具提供了相关的开发文档和更新日志）

## 拿到shell后的思路是什么

1. 查看当前用户权限以及可执行文件
2. 用户信息收集
3. 提权，寻找存在漏洞或者错误配置
4. 横向移动
5. 数据收集，配置文件，敏感信息，密钥文件等
6. 设置后门，持久化控制
7. 清理痕迹，删除临时文件，日志条目

## 如何判断目标操作系统

1. 大小写检测，linux对大小写敏感，windows对大小写不敏感
2. 根据ping指令返回的TTL值判断，windows一般情况下>100,linux<100

## 正向代理和反向代理的区别

正向代理是客户端代理，代理客户端，服务端不知道实际发起请求的客户端

反向代理是服务端代理，代理服务端，客户端不知道实际提供服务的服务端

## 正向shell和反向shell的区别

正向shell：攻击者连接被攻击者机器，可用于攻击者处于内网，被攻击者处于外网

反向shell：被攻击者主动连接攻击者，可用于被攻击者处于内网，攻击者处于外网

## 简单讲下反序列化漏洞

序列化是指程序将java对象转化为字节序列，反序列化则是将字节序列转化为java对象。

程序在进行反序列化的时候会调用一些函数，比如unserialize()，_construct()，destruct()，_wakeup()，sleep()函数等。如果这些函数在传递参数时，没有进行严格的过滤措施，就可以构造恶意代码并将其序列化后传入函数中，从而导致反序列化漏洞。

## 常见的中间件和对应的漏洞有哪些

1. IIS：（1）PUT漏洞，（2）短文件名猜解，（3）远程代码执行，（4）解析漏洞
2. apache：（1）解析漏洞，（2）目录遍历
3. Nginx：（1）文件解析，（2）目录遍历，（3）CRLF注入，（4）目录穿越
4. tomcat：（1）远程代码执行，（2）war后门文件部署
5. Jboss：（1）反序列化漏洞，（2）war后门文件部署
6. weblogic：（1）反序列化漏洞，（2）SSRF任意文件上传，（3）war后门文件部署
7. shiro：（1）shiro-550rememberme，（2）shiro-721paddingoracleattack

## 如何发现shiro漏洞

1. 登录失败时返回rememberme=deleteme字段
2. 使用shiroscan扫描工具

## 哪些漏洞会被高频利用

1. apacheshiro漏洞
2. fastjson漏洞
3. log4j漏洞
4. 上传漏洞

## 使用过哪些安全设备

1. webshell查杀：（1）D盾，（2）河马，（3）深信服的webshellkill
2. 病毒查杀：（1）火绒，（2）金山，（3）腾讯安全管家，（4）深信服EDR
3. 安全防护：（1）网站安全狗，（2）创宇盾，（3）云锁
4. 应急响应：（1）火绒剑，（2）微步云沙箱

## 绕过WAF的方法

1. 通配符？和*（？可替换任意非空字符，*可匹配任意长度）
2. 大小写绕过（select *from换成Select from）
3. 内联注释/**/（select/**/from）
4. 干扰字符污染（使用空格，空字符，tab换行，注释等字符）
5. 字符编码绕过
6. 脏数据填充（提交大量数据，绕过WAF）

## WAF的分类

1. 基于签名的WAF（检测已知漏洞特征，进行拦截）
2. 基于行为的WAF（分析请求，判断是否具备攻击性）
3. 综合型的WAF（结合基于签名和基于行为两种技术，能够同时检测已知漏洞和未知漏洞）

## WAF和IPS的区别

1. IPS是工作于防火墙和网络设备之间，WAF是工作于应用层
2. IPS是对防火墙的补充，综合能力更强一些，WAF主要是针对web页面的防护

## 有了解过态势感知产品吗

1. 360态势感知
2. 腾讯云安全大脑
3. 奇安信NGSOC
4. 启明星辰安全态势感知

## 防火墙了解吗

1. 过滤进出网的数据
2. 防止不安全的协议和服务
3. 管理进出网络的访问行为
4. 防止外部对内部网络信息的获取

## 无法连接3389的情况

1. 3389端口处于关闭状态
2. 端口号被修改
3. 端口不对外开放
4. 防火墙拦截

## 如何区分扫描流量和手动流量

1. 查看流量来源，扫描流量的IP来源通常不固定，而手动流量IP来源是固定的
2. 检测流量的规律和频率，扫描流量有周期性，规律性的访问行为
3. 观察流量的请求路径和参数，扫描流量路径相对固定，参数变化，而手动流量包含更加丰富的请求路径和参数

## 如何判断是钓鱼邮件

1. 微步查一下发件IP是否为恶意IP
2. 把邮件放到沙箱里查看

## 反弹shell的原理是什么

- 利用tcp协议传了一个bash环境

## 拿到webshell发现不出网会怎么办

1. 如果是都不出网的情况下，上传工具进行正向连接，使用regeorg将流量给正向代理出来
2. 如果限制了部分协议不出网，则探测出网协议，采用隧道代理技术

## 常见的响应状态码有哪些

1. 404：请求资源不存在
2. 200：请求成功，但是需要结合请求体和响应体进行判断是否成功
3. 401：未授权状态，常见于HTTP的basic认证
4. 500：服务器内部错误，500也不代表攻击失败
5. 301：永久重定向到指定url
6. 302：暂时重定向到指定url

## 网站拿shell的方法有哪些

1. 文件上传
2. 后台编辑模板
3. sql注入写文件
4. 命令执行，代码执行
5. cms漏洞
6. wordpress上传插件包含脚本文件zip压缩包等

## linux挖矿病毒的应急响应

1. 排查进程，查看CPU占比较高的，找到相关进程进行查杀
2. 排查新建用户，隐藏用户，可疑账号
3. 排查启动项和计划任务
4. 日志分析

## 获得网站绝对路径的方法

1. 通过配置文件获取
2. 通过phpmyadmin获取
3. 配合命令执行漏洞获取

## windows或者linux被植入后门，讲下排查思路

1. 排查异常进程
2. 进行webshell查杀
3. 检查系统文件的操作记录
4. 检查系统用户，找出可疑，新增用户
5. 检查计划任务，启动项，注册表

## 如何查找DNS解析记录

1. 查看浏览器缓存
2. 查看系统缓存
3. 查看DNS缓存
4. 查看路由器缓存

## 内网的认证协议有哪些

1. NTLM协议
2. kerberos协议

## NTLM协议

NTLM协议采用challenge/response认证机制

1. 协商：双方先确认一下传输内容的版本等各种信息
2. 质询：这是挑战/响应关键的一步
3. 验证：对质询的最后一个结果进行验证，验证通过后，允许访问资源

## kerberos协议原理

（服务请求->AD名单判断->返回TGT->再次请求->返回ticket->访问服务）

客户端向keberos发起服务请求，希望获取服务的权限，kerberos得到请求，先判断用户是否可信赖。

1. 根据AD存储中的黑白名单来判断客户是否值得信赖，验证成功后返回TGT
2. 客户根据得到的TGT再次请求服务，kerberos判断客户具有权限，给予客户访问的ticket
3. 得到tiket后，客户访问该服务，如果需要其他服务，需要向TGS申请

## 横向移动的命令执行有哪些

psexec，wmic，smbexec，winrm，netuse

## 公司给你一个网站你应该做什么

1. 信息收集
2. 漏洞扫描
3. 漏洞利用
4. 权限提升
5. 日志清理
6. 总结报告

## 常见的中间件有哪些

1. IIS
2. Nginx
3. Apache
4. Tomcat
5. Weblogic
6. Jboss
7. llighttpd

## HTTP和HTTPS的区别

1. HTTPS协议需要申请CA证书，并且该证书需要一定的费用（证书不同）
2. HTTP是超文本传输协议，明文传输，而HTTPS是具有安全性的SSL加密传输（传输方式不同）
3. HTTP和HTTPS的连接端口不同，前者是80，后者是443（端口不同）

## 常用的webshell检测工具

1. D盾
2. 河马webshell
3. Web shell detector

## 横向移动方法

1. IPC横向，建立IPC连接后，使用计划任务执行木马进行上线
2. WMI横向，利用系统内置程序，进行命令执行
3. smb横向
4. 利用MSF进行密码喷洒
5. 哈希传递

## msf流量特征

1. 数据包中有metepreter，revshell等字符
2. msf流量涉及多种网络协议，如TCP,HTTP和HTTPS等
3. 变量连接，msf的连接方式中可能包括正向连接和反向连接

## PHP的魔术方法

1. __tostring
2. __unserialize
3. __wakeup
4. __get
5. __call

## 溯源思路

1. 攻击源捕获，通过分析设备的告警，钓鱼邮件，木马病毒，日志流量分析等找到攻击者的IP
2. 溯源反制，将攻击者的ip放在威胁感知分析平台进行分析
3. 如果该ip存在web，查询网站的备案号看是否可以获取到个人信息
4. 随后对该ip的web站点进行渗透，看是否可以控制其机器，从而获取更多的信息
5. 利用获取到的攻击者个人信息，例如电话号码或者邮箱，对其进行社工，尝试获取更多的信息
6. 总之溯源的目的就是利用现有的信息通过各种手段扩大信息的获取，从而对攻击者进更加精准的确认

## 应急响应流程

1. 收集信息，收集客户信息和主机信息进行保存
2. 判断类型，根据服务器的失陷时间和态势感知的告警，判断是何种安全事件
3. 抑制影响范围，对日志和流量进行分析，确定攻击路径，判断漏洞点，切断攻击路径，判断服务器资产，影响范围以及严重程度，确认是否需要下线服务，
4. 深入分析，排查取证，清理处置。查看web日志，根据失陷时间节点向上排查是否上传webshell，如果存在，则用D盾和河马进行查杀，再排查后门是否存在恶意的命令执行，文件上传，如果有恶意文件比如exe，可以放到微步分析
5. 查看其他主机是否存在相同攻击迹象，排查是否存在可疑进程，端口，自启动项，可用火绒剑查看是否存在异常外联
6. 在完成上述内容后，再观察一段时间，看看有没有流量反连，有没有内存马的存在
7. 根据样本分析得到的IP地址进行信息收集，进行常规的溯源，查看是否有个人ID的泄露，社交平台是否存在其个人信息，利用蜜罐系统反制等手段绘制攻击者画像

## log4j2远程代码执行漏洞原理

1. log4j2框架中存在JNDI Lookup的功能，该功能允许通过配置文件中的JNDI名称引用外部资源
2. 如果JNDI指向ldap或者rmi服务，那么就可以通过远程执行任意命令或者获取敏感信息

## log4j漏洞的流量特征

1. 数据包里有{jndi:ladp//}字段
2. 命令执行攻击，有回显的响应体中存在命令执行的结果
3. 命令执行攻击，无回显的存在源IP与ldap服务的外联日志记录

## log4j如何判断攻击成功

1. 分析主机是否加载远程恶意类
2. 分析主机是否存在与dnslog或者ldap，rmi远程服务的外联记录

## 网站被上传webshell如何处理

1. 首先关闭网站，切断服务
2. 使用D盾对网站目录进行查杀

## shiro反序列化流量特征

1. 请求包cookie中的rememberme中存在AES+base64加密的一串java反序列化代码
2. 响应包中存在bas64的加密数据
3. 数据包含义多个$$$符号，base64编码

## 判断shiro反序列化漏洞是否攻击成功

1. 分析流量，分析请求包中rememberme cookie处恶意的序列化数据是否能绕过检查规则
2. 分析流量，分析响应包状态，如果返回了异常错误信息，如java反序列化异常，则表明攻击可能成功

## java内存马类型

1. Filter
2. Listener
3. Servlet
4. Websocket
5. javaagent

## 用过哪些设备

1. 入侵防御系统IPS，检测系统IDS
2. 堡垒机
3. WAF
4. 蜜罐
5. 漏扫
6. 态势感知系统

## 设备出现误报怎么办

- 误报就是规则问题，上报处置，提供规则优化建议

## 如何判断误报和真实攻击 

1. 分析流量特征，分析请求包内是否存在恶意请求以及响应包是否响应相关的敏感信息
2. 主要是看告警的数据包中的源IP，url请求是否存在特殊字符或者sql语句，分析其与正常业务数据包的区别
3. 如果是设备误报，说明需要进行策略升级不用处置

## 如何判断攻击是否真实，是否攻击成功

1. 分析流量特征，分析请求包和响应包，payload和告警信息是否匹配
2. 分析请求包是否存在命令执行，响应包是否存在目录执行的结果返回

## 已知攻击者IP，如何溯源定位攻击人员

1. Ip反查注册信息，可能会查询到域名
2. 通过域名备案查询邮箱电话
3. 通过社工库查询相关邮箱和电话信息定位攻击人员

## struts2有哪些漏洞，有什么特征

漏洞：文件上传，命令执行，ognl表达式注入

特征：

1. 文件目录可能是.action或者.do
2. 返回的页面可能存在struts2等字符
3. 如果是ognl表达式注入就会使用ognl语法，请求参数会有${}.%{}字符

## 如何判断fastjson反序列化漏洞攻击成功

1. 分析流量特征，POST的请求方法，content-type为application/json
2. 分析流量特征，@type是指向com.sun.rowset.jdbcRowsetimpl,datasourcename等远程加载类
3. 分析流量特征，json数据体内是否存在ladp 或者rmi服务器的地址
4. 状态码为：400 也可能是500

## 如何分析文件上传告警是否攻击成功

1. 分析流量特征，分析响应体判断服务器是否接受了该上传请求，上传成功通常状态码为200
2. 分析流量特征，分析响应体中是否响应了上传路径，访问该上传路径查看文件是否被解析是否存在
3. 通过查看态势感知日志判断文件是否落地

## **如何研判sql注入类型告警事件？**

1. 分析流量，请求包内是否有相关的恶意sql语句
2. 分析流量，响应体内是否返回数据库敏感信息，或者系统信息。

## sqlmap流量特征

1. UA头通常包含sqlmap关键字
2. 攻击流量存在一定的规律和顺序
3. payload的一般具有模块化特征

## CS心跳包的研判

1. CS默认端口50050，心跳包的时间间隔一样
2. 数据通常是加密或者base64编码的
3. 如果没有采用CDN域前置的话，域名和IP是暴露的

## weblogic默认端口号是多少，漏洞原理是什么

1. weblogic的控制台的7001端口会默认开启T3协议服务，T3协议触发的weblogic server WLS core components中存在反序列化漏洞，攻击者可以发送构造恶意的T3协议数据，获取目标服务器的权限

## 黄金票据和白银票据的区别

- 黄金票据是AS服务返回的身份票据TGT，可以允许该身份访问所有的服务
- 白银票据则是TGS返回的身份票据ST，该票据智能访问某个指定的服务

## 黄金票据和白银票据利用的前提

黄金票据

1. 需要伪造的域管理员用户名
2. 完整的域名
3. 域SID
4. krbtgt用户的hash

白银票据

1. 要伪造的用户名
2. 域名
3. 域SID
4. 服务账号的NTLM Hash
5. 可利用的服务

## 国护的流程

1. 入场，调试设备，确定好组织架构，分配岗位，指定排班表
2. 签订保密协议，使用指定的通讯软件。
3. 监控-研判溯源-应急处置-监控了解处置情况
4. 每日结束开会，汇总当日情况，做出决策

## 如何判断一个网站是否为fastjson框架

1. 结合页面分析，是否出现json等字符
2. 分析前端代码，是否有fastjson的相关引用和调用
3. 分析流量，响应头和响应体中是否有fastjson相关标识

## fastjson不出网并且无回显怎么办

- 将执行命令结果写入到一些js文件或者静态文件中，通过web端去访问

## fastjson反序列化流量特征

1. @type指定远程加载类
2. 数据包中常见ladp，rmi远程服务器的地址
3. 请求方法一般为POST
4. content-type设置为application/json

## fastjson如何研判

- 查看目标IP和服务器IP，查看是否存在请求服务

## 内存马的排查和处置

- 排查：根据安全设备上的告警，查看对应的文件，如果访问的是一个不存在的位置或者是图标之类的ico，但是响应状态码还是200，大概率就是内存马
- java内存马的排查思路

1. 在java中，只有被JVM加载后的类才能被调用，因此检测思路为：dump JVM已加载的class字节码，反编译成java代码，进行源码的webshell检测

- 处置：在客户允许的情况下重启web中间件，或者重启整台机器，如果客户不允许，可以用内存马查杀工具，自动化跑出来JVM里危险的类，结合经验进行内存马的处置

## 内存马原理

1. 修改中间件的组件或动态注册一个新的组件，插入恶意shellcode，达到持久化控制服务器
2. 简单来说，内存马就是修改中间件组件或者动态注册组件，并向其插入shellcode，达到持久化控制服务器的目的

## 内存马与一般webshell的区别

- 内存马是无文件马，利用中间件执行某些恶意代码，不会有文件落地

## 如果有上千条告警的话如何快速处置

- 确认大量告警的IP是否为同一IP，如果是同一IP则进行IP封禁
- 查看攻击IP是在内网还是外网

1. 如果是内网，询问相关机器管理员后再进行进一步处置
2. 如果是外网，查看UA头，判断是不是sqlmap和AWVS等漏扫，是的话直接封禁

- 根据告警优先级，优先查看危急，高危，和失陷类型的告警

## 渗透项目的基本流程

1. 确定目标
2. 信息收集
3. 漏洞探测
4. 漏洞利用getshell
5. 内网转发
6. 内网渗透
7. 痕迹清除
8. 撰写渗透测试报告

## 数据包或者日志的分析思路

1. 用流量监控的安全设备，分析报文中的host字段，用微步查询host是否为恶意
2. wireshark查看请求的网站路径，源IP和目的IP，host字段的值以及发包的内容

## cookie和session的区别

1. cookie保存在客户端，session保存在服务端
2. 两者都有有效期

## telnet和ssh的区别

- telnet是明文传输，ssh是密文传输

## 态势感知平台的使用方法

1. 处置中心查看被攻击的详细信息
2. 查看请求头，请求体，响应头，根据相应的流量来分析告警的真实性
3. 如发现明显的sql注入或者暴力破解或者XSS等攻击行为，第一时间进行封禁和上报

## 判断sql注入是攻击还是误报

- 看url，如果是攻击，会存在单引号，双引号，双重破折号，分号等字符特征

## thinkphp流量特征

1. Url：/index/think/app/invokefunction
2. 关键的PHP函数，call_user_function,system,exec,shell_exec,eval

## weblogic的流量特征

1. 请求路径为weblogic的特殊路径/weblogic/console，/weblogic/wls_wsat之类的
2. 流量中的标签可能插入特殊字符或者恶意的XML结构
3. T3协议的端口7001或者7002
4. 流量中存在ldap，rmi远程调用的地址

## linux的启动项文件

- /etc/init.d或/etc/systemd/system/

## XML的流量特征

1. Xml version ，method，xxe之类的标签
2. content-type:application/xml
3. 标签里插入特殊字符或者恶意的xml结构
4. POST请求方法，XML数据通常通过POST方法发送

## 拿下数据库后的步骤

1. 权限提升
2. 数据导出
3. 持久化访问
4. 横向移动

## 监控三步走

1. 看告警详细信息，查看请求头，url是否是恶意payload进而判断是否为攻击，查看响应头，响应状态码如何，响应体是否回显内容，有没有返回一些敏感信息
2. 授权登录，按照告警的详细信息，进行授权复现，证明是否存在，如果是文件泄露类的，就将文件下载下来进行判断，如果是XSS的，那就将响应体内容到html中，通过web进行浏览查看是否会造成弹窗
3. 判断请求头请求体中的payload是否存在命令执行，或者注入语句之类的

## 哥斯拉研判

1. 主要就是请求体的cookie末尾可能会存在；号
2. base64的加密
3. pass=的字段
4. 根据攻击IP和受害IP进行日志检索，查看连接的一个流量

## 冰蝎的流量特征

1. 请求体里有明显的base64加解密的函数
2. 都有密钥，密钥是密码md5值的前16位
3. 请求包的话都有content-type的字段
4. 都是AES对称加密
5. 冰蝎3.0内置的16个ua头
6. 冰蝎4.0内置10个ua头，并且与目标主机连接的时候会建立TCP的连接，连接的本地端口是49700左右的一个端口

## strust2的流量特征

1. 请求头请求体里有明显的ognl表达式和一些关键字method等
2. content-type字段为application/x-www-form-urllencode
3. Class参数，一些命令执行之类的

## 命令执行

1. 有回显的话直接看响应体的命令执行结果即可
2. 无回显的话就进行日志检索，查看是否存在源Ip与ldap服务Ip的外联日志

## 威胁情报产生误报的原因

1. 防火墙或者邮件网关有发起黑域名解析的行为
2. 威胁情报失效了，需要更新威胁情报

## 反序列化漏洞流量特征

1. 常见的一些恶意类和方法调用，如spring，beanshell等
2. Java序列化对象标志，java序列化对象以特定的字节序列开头，如0xACED0005
3. base64编码，序列化数据通常是采用base64进行一个编码的

## 内存马的应急

1. 进程分析，查看系统进程信息，分析是否存在异常的进程
2. 系统日志分析，查看是否存在可疑行为，可以借助工具volatility等进行分析
3. 网络监测工具，wireshark等，捕获网络流量，排查可疑的网络请求和通信行为
4. 安全软件扫描，进行全面的扫描和检测查杀
5. 